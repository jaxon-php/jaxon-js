/*
    @package jaxon
    @version $Id: jaxon.core.js 327 2007-02-28 16:55:26Z calltoconstruct $
    @copyright Copyright (c) 2005-2007 by Jared White & J. Max Wilson
    @copyright Copyright (c) 2008-2010 by Joseph Woolley, Steffen Konerow, Jared White  & J. Max Wilson
    @copyright Copyright (c) 2017 by Thierry Feuzeu, Joseph Woolley, Steffen Konerow, Jared White  & J. Max Wilson
    @license https://opensource.org/license/bsd-3-clause/ BSD License
*/
var jaxon={version:{number:"5.2.2"},debug:{verbose:{}},ajax:{callback:{},command:{},parameters:{},request:{},response:{},upload:{}},cmd:{node:{},script:{},event:{},dialog:{}},parser:{attr:{},call:{},query:{}},utils:{dom:{},form:{},queue:{},types:{},string:{},log:{}},bag:{},dom:{},dialog:{},config:{}};!function(e,t){e.commonHeaders={"If-Modified-Since":"Sat, 1 Jan 2000 00:00:00 GMT"},e.postHeaders={},e.getHeaders={},e.waitCursor=!1,e.statusMessages=!1,e.baseDocument=document,e.requestURI=document.URL,e.defaultMode="asynchronous",e.defaultHttpVersion="HTTP/1.1",e.defaultContentType="application/x-www-form-urlencoded",e.defaultResponseDelayTime=1e3,e.convertResponseToJson=!0,e.defaultExpirationTime=1e4,e.defaultMethod="POST",e.defaultRetry=5,e.maxObjectDepth=20,e.maxObjectSize=2e3,e.commandQueueSize=1e3,e.requestQueueSize=1e3,e.httpRequestOptions={mode:"cors",cache:"no-cache",credentials:"same-origin",redirect:"manual"},e.status={update:{onPrepare:()=>t.consoleMode().debug("Sending Request..."),onRequest:()=>t.consoleMode().debug("Waiting for Response..."),onProcessing:()=>t.consoleMode().debug("Processing..."),onComplete:()=>t.consoleMode().debug("Done.")},dontUpdate:{onPrepare:()=>{},onRequest:()=>{},onProcessing:()=>{},onComplete:()=>{}}},e.cursor={update:{onRequest:()=>{jaxon.config.baseDocument.body&&(jaxon.config.baseDocument.body.style.cursor="wait")},onComplete:()=>{jaxon.config.baseDocument.body&&(jaxon.config.baseDocument.body.style.cursor="auto")},onFailure:function(){jaxon.config.baseDocument.body&&(jaxon.config.baseDocument.body.style.cursor="auto")}},dontUpdate:{onRequest:()=>{},onComplete:()=>{},onFailure:()=>{}}}}(jaxon.config,jaxon.utils.log),window.jaxon=jaxon,function(e,t,n){e.$=e=>e?t.isString(e)?n.getElementById(e):e:null;e.getBrowserHTML=t=>{const o=(()=>{const t=e.$("jaxon_temp_workspace");if(t)return t;const o=n.createElement("div");return o.setAttribute("id","jaxon_temp_workspace"),o.style.display="none",o.style.visibility="hidden",n.body.appendChild(o),o})();o.innerHTML=t;const a=o.innerHTML;return o.innerHTML="",a},e.willChange=(t,n,o)=>!!(t=e.$(t))&&o!=t[n],e.getAttrValue=(e,t)=>{if(null===(aMatches=t.match(/^(.+)\[(\d+)\]$/)))return e[t];t=aMatches[1];const n=parseInt(aMatches[2]);return e[t][n]},e.findFunction=(t,n=window)=>{const o=t.split("."),a=o.length;for(let t=0;t<a&&n;t++)n=e.getAttrValue(n,o[t]);return n??null},e.findObject=e.findFunction,e.getInnerObject=(t,n=window)=>{const o=t.split(".");t=o.pop();const a=o.length;for(let t=0;t<a&&n;t++){const a="css"===o[t]?"style":o[t];n=e.getAttrValue(n,a)}return n?{node:n,attr:t}:null}}(jaxon.utils.dom,jaxon.utils.types,jaxon.config.baseDocument),function(e,t,n){const o=e=>Array.from(e).filter(({selected:e})=>e).map(({value:e})=>e),a=(e,t,n)=>"select-multiple"!==e?t:o(n).pop(),r=(e,t,n,r,s,i)=>{const l={obj:e,key:t},c=/\[(.*?)\]/;for(;null!==(matches=n.match(c));){const e=matches[1].trim();if(""===e){const e=l.obj[l.key]??[];return void(l.obj[l.key]="select-multiple"===r?o(i):[...e,s])}void 0===l.obj[l.key]&&(l.obj[l.key]={}),l.obj=l.obj[l.key],l.key=e,n=n.substring(matches[0].length)}l.obj[l.key]=a(r,s,i)},s=(e,t)=>{t.forEach(t=>{const{childNodes:o=null,type:i}=t;null!==o&&"select-one"!==i&&"select-multiple"!==i&&s(e,o),((e,{type:t,name:o,tagName:s,checked:i,disabled:l,value:c,options:u})=>{const{prefix:d,formId:p,withDisabled:m}=e;if(((e,t,n,o,a,r,s,i)=>!t||"PARAM"===n||!s&&i||o.length>0&&o!==t.substring(0,o.length)||("radio"===e||"checkbox"===e)&&!r||("select-one"===e||"select-multiple"===e)&&void 0===a||"file"===e)(t,o,s,d,c,i,m,l))return;let g=o.match(/^([a-zA-Z_][a-zA-Z0-9_-]*)((\[[a-zA-Z0-9_-]*\])*)$/);if(!g)return n.warning(`Invalid field name ${o} in form ${p}.`),void n.warning(`The value of the field ${o} in form ${p} is ignored.`);if(!g[3])return void(e.values[o]=a(t,c,u));const x=g[1],f=g[2];r(e.values,x,f,t,c,u)})(e,t)})};e.getValues=(e,n=!1,o="")=>{const a={formId:e,withDisabled:!0===n,prefix:o??"",values:{}},{childNodes:r}=t.$(e)??{};return r&&s(a,r),a.values}}(jaxon.utils.form,jaxon.utils.dom,jaxon.utils.log),function(e,t,n,o){const a={console:!1},r=()=>{a.console=!1};e.consoleMode=()=>(a.console=!0,e);const s=(e,t)=>e+(n.isObject(t)?": "+JSON.stringify(t):"");e.logger=()=>a.console||o.active||!o.logger?null:t.findObject(o.logger),e.error=(t,n)=>{console.error(s(t,n)),e.logger()?.error(t,{...n}),r()},e.warning=(t,n)=>{console.warn(s(t,n)),e.logger()?.warning(t,{...n}),r()},e.notice=(t,n)=>{console.log(s(t,n)),e.logger()?.notice(t,{...n}),r()},e.info=(t,n)=>{console.info(s(t,n)),e.logger()?.info(t,{...n}),r()},e.debug=(t,n)=>{console.debug(s(t,n)),e.logger()?.debug(t,{...n}),r()}}(jaxon.utils.log,jaxon.utils.dom,jaxon.utils.types,jaxon.debug),function(e){e.create=e=>({start:0,count:0,size:e,end:0,elements:[],paused:!1}),e.empty=e=>e.count<=0,e.full=e=>e.count>=e.size,e.push=(t,n)=>{if(e.full(t))throw{code:10003};return t.elements[t.end]=n,++t.end>=t.size&&(t.end=0),++t.count},e.pushFront=(t,n)=>{if(e.full(t))throw{code:10003};return e.empty(t)?e.push(t,n):(--t.start<0&&(t.start=t.size-1),t.elements[t.start]=n,++t.count)},e.pop=t=>{if(e.empty(t))return null;let n=t.elements[t.start];return delete t.elements[t.start],++t.start>=t.size&&(t.start=0),t.count--,n},e.peek=t=>e.empty(t)?null:t.elements[t.start]}(jaxon.utils.queue),function(e){e.doubleQuotes=e=>void 0!==e&&e.replace(new RegExp("'","g"),'"'),e.singleQuotes=e=>void 0!==e&&e.replace(new RegExp('"',"g"),"'"),e.stripOnPrefix=e=>0===(e=e.toLowerCase()).indexOf("on")?e.replace(/on/,""):e,e.addOnPrefix=e=>0!==(e=e.toLowerCase()).indexOf("on")?"on"+e:e,e.supplant=(e,t)=>e.replace(/\{([^{}]*)\}/g,(e,n)=>{const o=typeof t[n];return"string"===o||"number"===o?t[n]:e})}(jaxon.utils.string),function(e){e.of=e=>Object.prototype.toString.call(e).slice(8,-1).toLowerCase(),e.isObject=t=>"object"===e.of(t),e.isArray=t=>"array"===e.of(t),e.isString=t=>"string"===e.of(t),e.isFunction=t=>"function"===e.of(t),e.toInt=e=>parseInt(e),Array.prototype.top||(Array.prototype.top=function(){return this.length>0?this[this.length-1]:void 0})}(jaxon.utils.types),function(e,t,n,o,a,r,s){const i={labels:{confirm:{yes:"Yes",no:"No"}},options:{},defaults:{}},l={};e.config=({labels:e,options:t={},defaults:n={}})=>{r.isObject(t)&&(i.options=t),i.labels.confirm={...i.labels.confirm,...e.confirm},i.defaults={...i.defaults,...n}};const c=(e,t)=>{if(l[e]&&l[e][t])return l[e];l[e]?s.warning(`The chosen dialog library doesn't implement the "${t}" function.`):s.warning(`Unable to find a dialog library with name "${e}".`);const n="show"===t||"hide"===t?"modal":t;return i.defaults[n]?l[i.defaults[n]]:(l.default[t]||s.error(`Unable to find a dialog library with the "${t}" function.`),l.default)};e.alert=(e,{type:t,title:n="",text:o})=>c(e,"alert").alert({type:t,message:o,title:n}),e.confirm=(e,{title:t="",text:n},o)=>c(e,"confirm").confirm({question:n,title:t},o),e.show=(e,t)=>{const o=c(e,"show");return o.show&&o.show(t,e=>e&&n.process(e)),!0},e.hide=e=>{const t=c(e,"hide");return t.hide&&t.hide(),!0};const u=e=>{const t="abcdefghijklmnopqrstuvwxyz";let n="";for(let o=0;o<e;o++)n+=t.charAt(Math.floor(26*Math.random()));return n};e.register=(e,n)=>{l[e]={};const{labels:{confirm:s},options:c}=i,d={labels:s,...r.isObject(c[e])?c[e]:{}},p={...r,ready:t.ready,js:o.execExpr,jq:a.select,createUniqueId:u};n(l[e],d,p)},e.register("default",e=>{const t=(e,t)=>e?e.toUpperCase()+"\n"+t:t;e.alert=({message:e,title:n})=>alert(t(n,e)),e.confirm=({question:e,title:n},{yes:o,no:a})=>confirm(t(n,e))?o():a&&a()})}(jaxon.dialog,jaxon.dom,jaxon.parser.attr,jaxon.parser.call,jaxon.parser.query,jaxon.utils.types,jaxon.utils.log),function(e){"use strict";let t=[],n=!1,o=!1;const a=()=>{n||(n=!0,t.forEach(e=>e.fn.call(window,e.ctx)),t=[])};e.ready=function(e,r){n?setTimeout(function(){e(r)},1):(t.push({fn:e,ctx:r}),"complete"===document.readyState||!document.attachEvent&&"interactive"===document.readyState?setTimeout(a,1):o||(document.addEventListener("DOMContentLoaded",a,!1),window.addEventListener("load",a,!1),o=!0))}}(jaxon.dom),function(e,t){const n={nodes:{}},o="main";e.reset=()=>n.nodes={};const a=(e,t,n)=>{if(!e.querySelectorAll)return[];const o=Array.from(e.querySelectorAll(`:scope [${t}]`));return n&&e.hasAttribute(t)?[e,...o]:o},r=(e,n)=>a(e,"jxn-on",n).forEach(e=>((e,n,o)=>{if(!n.hasAttribute("jxn-call"))return;const a=n.getAttribute(o).trim(),r=JSON.parse(n.getAttribute("jxn-call"));t.setEventHandler({event:a,func:r},{target:e})})(e,e,"jxn-on")),s=(e,n,o,a)=>{e.querySelectorAll(`:scope ${n}`).forEach(e=>{t.setEventHandler({event:o,func:a},{target:e})})};e.bind=(e,t,a)=>{a||(a=o),n.nodes[`${t}_${a}`]=e};e.process=(n=document,o=!1)=>{((e,t)=>{a(e,"jxn-event",t).forEach(e=>{const t=JSON.parse(e.getAttribute("jxn-event"));t?.forEach(({select:t,event:n,handler:o})=>{s(e,t,n,o)})})})(n,o),r(n,o),((e,n)=>{a(e,"jxn-click",n).forEach(e=>{const n=JSON.parse(e.getAttribute("jxn-click"));t.setEventHandler({event:"click",func:n},{target:e})})})(n,o),((t,n)=>{a(t,"jxn-bind",n).forEach(t=>e.bind(t,t.getAttribute("jxn-bind"),t.getAttribute("jxn-item")))})(n,o)};e.node=(e,t=o)=>{const a=n.nodes[`${e}_${t}`]??null;return null!==a&&a.isConnected?a:(null!==a&&delete n.nodes[`${e}_${t}`],((e,t)=>{const o=`[jxn-bind="${e}"][jxn-item="${t}"]`,a=document.querySelector(o);return null!==a&&(n.nodes[`${e}_${t}`]=a),a})(e,t))}}(jaxon.parser.attr,jaxon.cmd.event),function(e,t,n,o,a,r,s,i){const l={eq:(e,t)=>e==t,teq:(e,t)=>e===t,ne:(e,t)=>e!=t,nte:(e,t)=>e!==t,gt:(e,t)=>e>t,ge:(e,t)=>e>=t,lt:(e,t)=>e<t,le:(e,t)=>e<=t,error:()=>!1},c={select:({_name:e,mode:n,context:o=null},a)=>{if("this"===e){const{context:{target:e}={}}=a;return"jq"===n?{call:"$(this)",value:t.select(e)}:{call:"this",value:"js"===n?e:null}}const{context:{global:r}={}}=a;return"jq"===n?{call:`$('${e}')`,value:t.select(e,t.context(o,r))}:{call:`document.getElementById('${e}')`,value:document.getElementById(e)}},event:({_name:e,mode:t,func:n},o)=>{const a=e=>v(n,{...o,context:{...o.context,event:e,target:e.currentTarget},value:null}),{value:r,call:s}=o;return"jq"===t?r.on(e,a):r.addEventListener(e,a),{call:"jq"===t?`${s}.on(${e}, [handler])`:`${s}.addEventListener(${e}, [handler])`,value:r}},func:({_name:e,args:t=[]},n)=>{const{value:a,call:r}=n,l=(r?`${r}.${e}`:e)+"()",c=o.findFunction(e,a||window);return c?{call:l,value:c.apply(a,m(t,n))}:"trim"===e?{call:`trim(${e})`,value:a.trim()}:"toInt"===e?{call:`parseInt(${e})`,value:s.toInt(a)}:(i.error(`Call to undefined function ${l}.`),{call:l,value:void 0})},attr:({_name:e,value:t},n)=>{const{value:a,depth:r,call:s}=n;if(0===r&&("window"===e||""===e))return t?(i.error('Cannot assign the "window" var.'),{call:"null",value:null}):{call:"window",value:window};const l=s?`${s}.${e}`:e,c=((e,t,n,a)=>{if(!e)return;const r=o.getInnerObject(t,e);return r?(void 0!==n&&(r.node[r.attr]=p(n,a)),r.node[r.attr]):void 0})(a||window,e,t,n);return void 0===c&&i.error(`Call to undefined variable ${l}.`),{call:l,value:c}},invalid:e=>(i.error("Invalid command: "+JSON.stringify({call:e})),{call:void 0,value:void 0}),unknown:e=>(i.error("Unknown command: "+JSON.stringify({call:e})),{call:void 0,value:void 0})},u=e=>s.isObject(e)&&!!e._type,d=(e,t)=>{const{trim:n,toInt:o}=e;return n&&(t=t.trim()),o&&(t=s.toInt(t)),t},p=(e,t)=>{if(!u(e))return e;const{_type:n,_name:a}=e;switch(n){case"form":return r.getValues(a);case"html":return d(e,o.$(a).innerHTML);case"input":return d(e,o.$(a).value);case"checked":return o.$(a).checked;case"expr":return v(e,f(t));default:return}},m=(e,t)=>e.map(e=>p(e,t));e.execCommand=(e,t)=>{const n=u(e)?c[e._type]??c.unknown:c.invalid;t.depth++;const{call:o,value:a}=n(e,t);return t.call=o,t.value=a,t};const g=(t,n)=>e.execCommand(t,n).value,x=({component:e,target:t,event:n})=>({context:{global:e?t??null:null,target:t,event:n},value:null}),f=e=>({...e,value:null});e.execCall=(e,t={})=>{const n=x(t);return n.depth=-1,s.isObject(e)&&g(e,n)};const j=(e,t)=>(t.depth=-1,e.reduce((e,n)=>void 0===e?void 0:g(n,t),null)),h=({str:e,args:t},n)=>a.supplant(e,t.reduce((e,t,o)=>({...e,[o+1]:p(t,n)}),{}));e.makePhrase=e=>h(e,{context:{}});const b=({lib:e,message:t}={},o)=>!!t&&n.alert(e,{...t,text:h(t.phrase,o)}),v=(e,t)=>{const{calls:o,confirm:a,condition:r,alert:s}=e;if(a)(({lib:e,question:t},o,a,r)=>{n.confirm(e,{...t,text:h(t.phrase,f(r))},{yes:()=>j(a,f(r)),no:()=>b(o,f(r))})})(a,s,o,t);else{if(!r)return j(o,t);((e,t,n,o)=>{const[a,r,s]=e;(l[a]??l.error)(p(r,f(o)),p(s,f(o)))?j(n,f(o)):b(t,f(o))})(r,s,o,t)}};e.execExpr=(e,t={})=>s.isObject(e)&&v(e,x(t))}(jaxon.parser.call,jaxon.parser.query,jaxon.dialog,jaxon.utils.dom,jaxon.utils.string,jaxon.utils.form,jaxon.utils.types,jaxon.utils.log),function(e){e.jq=null,e.context=(t,n)=>t?n?e.select(t,n).first():e.select(t).first():n,e.select=(t,n=null)=>(e.jq||(e.jq=window.jQuery??window.chibi),n?e.jq(t,n):e.jq(t))}(jaxon.parser.query),function(e,t,n,o){const a=["onInitialize","onProcessParams","onPrepare","onRequest","onResponseDelay","onExpiration","onResponseReceived","onProcessing","onFailure","onRedirect","onSuccess","onComplete"],r=e=>({timer:null,delay:e});e.timers=(e,t)=>({onResponseDelay:r(e??o.defaultResponseDelayTime),onExpiration:r(t??o.defaultExpirationTime)}),e.create=(t,n)=>({timers:e.timers(t,n)});e.initCallbacks=r=>{const s=(({callback:e,func:o})=>e?t.isArray(e)?e:t.isObject(e)?[e]:(n.warning(`Invalid callback value ignored on request to ${o.name}.`),[]):[])(r),i=s.filter(e=>t.isObject(e)).map(e=>({...e,timers:{...e.timers}}));i.length!==s.length&&n.warning(`Invalid callback object ignored on request to ${r.func.name}.`);const l=(n=>{const o=e.create();return a.forEach(e=>{t.isFunction(n[e])&&(o[e]=n[e],delete n[e])}),Object.keys(o).length>1?[o]:[]})(r),c=r.statusMessages?o.status.update:o.status.dontUpdate,u=r.waitCursor?o.cursor.update:o.cursor.dontUpdate;r.callbacks=[c,u,...i,...l]};const s=({timers:e},n)=>t.isObject(e)?e[n]:null;e.execute=(e,n)=>e.callbacks.forEach(o=>((e,n,o)=>{const a=e[n];if(!a||!t.isFunction(a))return;const r=s(e,n);r?r.timer=setTimeout(()=>a(o),r.delay):a(o)})(o,n,e));e.clearTimer=(e,n)=>e.callbacks.forEach(e=>((e,n)=>{const o=s(e,n);t.isObject(o)&&clearTimeout(o.timer)})(e,n))}(jaxon.ajax.callback,jaxon.utils.types,jaxon.utils.log,jaxon.config),function(e,t,n,o,a,r,s,i){const l={};e.register=(e,t,n="")=>l[e]={desc:n,func:t},e.unregister=e=>{const t=l[e];return t?(delete l[e],t.func):null},e.isRegistered=({name:e})=>void 0!==e&&void 0!==l[e],e.call=(e,t,n)=>{const{func:o,desc:a}=l[e];return n.command.desc=a,o(t,n)},e.execute=t=>{const{command:{name:o,args:a={},component:s={}}}=t;return e.isRegistered({name:o})?(s.name&&(t.target=n.node(s.name,s.item),t.target||i.error("Unable to find component node: "+JSON.stringify(s))),!t.target&&a.id&&(t.target=r.$(a.id),t.target||i.error("Unable to find node with id : "+a.id)),e.call(o,a,t),!0):(i.error("Trying to execute unknown command: "+JSON.stringify({name:o,args:a})),!0)};const c=t=>{try{return e.execute(t),!0}catch(e){i.error(e)}return!1};e.processQueue=(e,t=0)=>{for(;t>0&&e.count>1&&null!==a.pop(e);)--t;let n=null;for(e.paused=!1;!e.paused&&null!==(n=a.pop(e));)if(!c(n))return},e.pause=(t,n)=>{t.paused=!0,n((n=0)=>e.processQueue(t,n))},e.processCommands=n=>{const{response:{content:r}={}}=n;if(!s.isObject(r))return;const{debug:{message:l}={},jxn:{commands:c=[]}={}}=r;l&&i.console(l),o.execute(n,"onProcessing");const u=a.create(t.commandQueueSize);u.sequence=0,c.forEach(e=>a.push(u,{sequence:u.sequence++,command:{name:"*unknown*",...e},request:n,queue:u})),a.push(u,{sequence:u.sequence,command:{name:"response.complete",fullName:"Response Complete"},request:n,queue:u}),e.processQueue(u)}}(jaxon.ajax.command,jaxon.config,jaxon.parser.attr,jaxon.ajax.callback,jaxon.utils.queue,jaxon.utils.dom,jaxon.utils.types,jaxon.utils.log),function(e,t,n,o){const a={};e.setBagEntry=(e,t,n)=>void 0!==a[e]&&(a[e][t]=n,!0),e.getBagEntry=(e,t)=>void 0===a[e]?void 0:a[e][t],e.setBagValue=(o,a,r,s)=>{const i=e.getBagEntry(o,a);if(void 0===i||!t.isObject(i))return!1;const l=n.getInnerObject(r,i);return null!==l&&(l.node[l.attr]=s,!0)},e.getBagValue=(o,a,r,s)=>{const i=e.getBagEntry(o,a);return void 0!==i&&t.isObject(i)?n.findObject(r,i)??s:s},e.setBags=e=>{t.isObject(e)&&Object.keys(e).forEach(n=>{t.isObject(e[n])&&(a[n]=e[n])})};const r=e=>encodeURIComponent(JSON.stringify(e)),s=({func:e,parameters:n,bags:s=[]},i)=>{i("jxnr",(new Date).getTime()),i("jxnv",o.number),i("jxncall",r({...e,args:[...n].filter(e=>(e=>void 0!==e&&!t.isFunction(e))(e))})),s.length>0&&i("jxnbags",r(s.reduce((e,t)=>void 0===a[t]||null===a[t]?e:{...e,[t]:a[t]},{})))};e.process=e=>(({upload:{form:e,input:t}={}})=>e&&t)(e)?(e=>{e.requestData=new FormData,s(e,(t,n)=>e.requestData.append(t,n));const{name:t,files:n}=e.upload.input;n&&[...n].forEach(n=>e.requestData.append(t,n))})(e):(e=>{const t=[];s(e,(e,n)=>t.push(e+"="+n)),"POST"!==e.method?(e.requestURI+=(-1===e.requestURI.indexOf("?")?"?":"&")+t.join("&"),e.requestData=""):e.requestData=t.join("&")})(e)}(jaxon.ajax.parameters,jaxon.utils.types,jaxon.utils.dom,jaxon.version),function(e,t,n,o,a,r,s){e.q={send:s.create(t.requestQueueSize),recv:s.create(2*t.requestQueueSize)},e.setCsrf=e=>{const n=t.baseDocument.getElementsByTagName("meta")||[];for(const o of n)if(o.getAttribute("name")===e){const e=o.getAttribute("content");return void(e&&(t.postHeaders["X-CSRF-TOKEN"]=e))}};e.initialize=n=>{(e=>{if(void 0===t.requestURI)throw{code:10005};["commonHeaders","postHeaders","getHeaders"].forEach(n=>e[n]={...t[n],...e[n]});const n={statusMessages:t.statusMessages,waitCursor:t.waitCursor,mode:t.defaultMode,method:t.defaultMethod,requestURI:t.requestURI,httpVersion:t.defaultHttpVersion,contentType:t.defaultContentType,requestRetry:t.defaultRetry,maxObjectDepth:t.maxObjectDepth,maxObjectSize:t.maxObjectSize,upload:!1,aborted:!1,response:{convertToJson:t.convertResponseToJson}};Object.keys(n).forEach(t=>e[t]=e[t]??n[t]),e.method=e.method.toUpperCase(),"GET"!==e.method&&(e.method="POST")})(n),a.initCallbacks(n),a.execute(n,"onInitialize"),r.initialize(n),n.submit=s.empty(e.q.send),n.queued=!1,n.submit&&"synchronous"!==n.mode||(s.push(e.q.send,n),n.queued=!0)},e.prepare=e=>{a.execute(e,"onPrepare"),e.httpRequestOptions={...t.httpRequestOptions,method:e.method,headers:{...e.commonHeaders,..."POST"===e.method?e.postHeaders:e.getHeaders},body:e.requestData},e.response=o.create(e)},e._send=e=>{a.execute(e,"onResponseDelay"),a.execute(e,"onExpiration"),a.execute(e,"onRequest"),fetch(e.requestURI,e.httpRequestOptions).then(e.response.converter).then(e.response.handler).catch(e.response.errorHandler)};const i=t=>{e.prepare(t),e._send(t)};e.submit=e=>{for(;e.requestRetry-- >0;)try{return void i(e)}catch(t){if(a.execute(e,"onFailure"),e.requestRetry<=0)throw t}},e.abort=e=>{e.aborted=!0,o.complete(e)},e.execute=(t,o)=>{if(void 0===t)return;const r=o??{};r.func=t,e.initialize(r),a.execute(r,"onProcessParams"),n.process(r),r.submit&&e.submit(r)}}(jaxon.ajax.request,jaxon.config,jaxon.ajax.parameters,jaxon.ajax.response,jaxon.ajax.callback,jaxon.ajax.upload,jaxon.utils.queue),function(e,t,n,o,a){const r=[0,200],s=[400,401,402,403,404,500,501,502,503],i=[301,302,307];e.isSuccessCode=e=>r.indexOf(e)>=0,e.isRedirectCode=e=>i.indexOf(e)>=0,e.isErrorCode=e=>s.indexOf(e)>=0;const l=(n,{http:{status:a,headers:r}})=>e.isSuccessCode(a)?(o.execute(n,"onSuccess"),t.processCommands(n),!0):e.isRedirectCode(a)?(o.execute(n,"onRedirect"),e.complete(n),window.location=r.get("location"),!0):!e.isErrorCode(a)||(o.execute(n,"onFailure"),e.complete(n),!0);e.received=e=>{const{aborted:t,response:n}=e;return t?null:(o.clearTimer(e,"onExpiration"),o.clearTimer(e,"onResponseDelay"),o.execute(e,"onResponseReceived"),n.processor(e,n))},e.create=t=>({processor:l,...t.response,converter:e=>(t.response.http=e,t.response.convertToJson?e.json():e.text()),handler:o=>{t.response.content=o,a.empty(n.q.send)||"synchronous"===t.mode?e.received(t):a.push(n.q.recv,t)},errorHandler:e=>{throw o.execute(t,"onFailure"),e}});const c=e=>a.empty(e)||"synchronous"===a.peek(e).mode?null:a.pop(e);e.complete=t=>{if(o.execute(t,"onComplete"),(e=>{delete e.func,delete e.requestURI,delete e.requestData,delete e.httpRequestOptions,delete e.response,delete e.callbacks,delete e.commonHeaders,delete e.postHeaders,delete e.getHeaders})(t),"synchronous"===t.mode){for(a.pop(n.q.send);null!==(recvRequest=c(n.q.recv));)e.received(recvRequest);for(;null!==(sendRequest=c(n.q.send));)n.submit(sendRequest);null!==(sendRequest=a.peek(n.q.send))&&n.submit(sendRequest)}}}(jaxon.ajax.response,jaxon.ajax.command,jaxon.ajax.request,jaxon.ajax.callback,jaxon.utils.queue),function(e,t,n){e.initialize=e=>{(e=>{if(!e.upload)return!1;e.upload={id:e.upload,input:null,form:null};const o=t.$(e.upload.id);return o?"file"!==o.type?(n.error("The upload input field with id "+e.upload.id+" is not of type file"),!1):0===o.files.length?(n.error("There is no file selected for upload in input field with id "+e.upload.id),!1):void 0===o.name?(n.error("The upload input field with id "+e.upload.id+" has no name attribute"),!1):(e.upload.input=o,e.upload.form=o.form,!0):(n.error("Unable to find input field for file upload with id "+e.upload.id),!1)})(e)||(e.postHeaders["content-type"]=e.contentType)}}(jaxon.ajax.upload,jaxon.utils.dom,jaxon.utils.log),function(e,t,n,o){e.execConfirm=({count:e,lib:a,question:r},{queue:s})=>(o.pause(s,o=>{t.confirm(a,{...r,text:n.makePhrase(r.phrase)},{yes:()=>o(),no:()=>o(e)})}),!0),e.showAlert=({lib:e,message:o})=>(t.alert(e,{...o,text:n.makePhrase(o.phrase)}),!0),e.showModal=({lib:e,dialog:n})=>(t.show(e,n),!0),e.hideModal=({lib:e})=>(t.hide(e),!0)}(jaxon.cmd.dialog,jaxon.dialog,jaxon.parser.call,jaxon.ajax.command),function(e,t,n,o){e.addHandler=({event:e,func:t},{target:a})=>(a.addEventListener(o.stripOnPrefix(e),n.findFunction(t),!1),!0),e.removeHandler=({event:e,func:t},{target:a})=>(a.removeEventListener(o.stripOnPrefix(e),n.findFunction(t),!1),!0);const a=(e,n,o)=>t.execExpr({_type:"expr",...n},{event:e,target:o});e.addEventHandler=({event:e,func:t,options:n},{target:r})=>(r.addEventListener(o.stripOnPrefix(e),e=>a(e,t,r),n??!1),!0),e.setEventHandler=({event:e,func:t},{target:n})=>(n[o.addOnPrefix(e)]=e=>a(e,t,n),!0)}(jaxon.cmd.event,jaxon.parser.call,jaxon.utils.dom,jaxon.utils.string),function(e,t,n,o,a,r){const s=(e,o,{node:a,attr:r},s)=>{if("outerHTML"!==r||!o.parentNode)return a[r]=s,void("innerHTML"===r&&t.process(o,!1));n.pause(e,e=>{new MutationObserver((n,a)=>{a.disconnect(),(o=n.length>0&&n[0].addedNodes?.length>0?n[0].addedNodes[0]:null)&&t.process(o,!0),e()}).observe(a.parentNode,{attributes:!1,childList:!0,subtree:!1}),a.outerHTML=s})};e.assign=({attr:e,value:t},{target:n,queue:a})=>{const r=o.getInnerObject(e,n);return null!==r&&s(a,n,r,t),!0},e.append=({attr:e,value:t},{target:n,queue:a})=>{const r=o.getInnerObject(e,n);return null!==r&&s(a,n,r,r.node[r.attr]+t),!0},e.prepend=({attr:e,value:t},{target:n,queue:a})=>{const r=o.getInnerObject(e,n);return null!==r&&s(a,n,r,t+r.node[r.attr]),!0};e.replace=({attr:e,search:t,replace:n},{target:r,queue:i})=>{const l=o.getInnerObject(e,r);return null!==l&&((e,t,n,r,i)=>{const l=a.isFunction(n.node[n.attr]),c=(l?n.node[n.attr].join(""):n.node[n.attr]).replaceAll(r,i);(l||o.willChange(n.node,n.attr,c))&&s(e,t,n,c)})(i,r,l,"innerHTML"===e?o.getBrowserHTML(t):t,n),!0},e.clear=(t,n)=>(e.assign({...t,value:""},n),!0),e.remove=(e,{target:t})=>(t.remove(),!0);const i=(e,t)=>{const n=r.createElement(e);return n.setAttribute("id",t),n};e.create=({tag:{id:e,name:t}},{target:n})=>(n&&n.appendChild(i(t,e)),!0),e.insertBefore=({tag:{id:e,name:t}},{target:n})=>(n&&n.parentNode&&n.parentNode.insertBefore(i(t,e),n),!0),e.insertAfter=({tag:{id:e,name:t}},{target:n})=>(n&&n.parentNode&&n.parentNode.insertBefore(i(t,e),n.nextSibling),!0),e.bind=({component:{name:e,item:n}},{target:o})=>(t.bind(o,e,n),!0)}(jaxon.cmd.node,jaxon.parser.attr,jaxon.ajax.command,jaxon.utils.dom,jaxon.utils.types,jaxon.config.baseDocument),function(e,t,n,o,a){e.execCall=({func:e,args:n,context:o},{target:a})=>(t.execCall({_type:"func",_name:e,args:n},{target:a,...o}),!0),e.execExpr=({expr:e,context:n},{target:o})=>(t.execExpr(e,{target:o,...n}),!0),e.sleep=({duration:e},{queue:t})=>(o.pause(t,t=>setTimeout(()=>t(),100*e)),!0),e.redirect=({url:e,delay:t})=>(window.setTimeout(()=>window.location=e,t<=0?5:1e3*t),!0),e.setDatabag=({values:e})=>(n.setBags(e),!0);const r=(e,t)=>e.map(e=>a.isObject(e)&&"page"===e._type?parseInt(t.parentNode.getAttribute("data-page")):e);e.paginate=({func:e},{target:n})=>{const o=n.querySelectorAll("li.enabled > a"),{args:a}=e;return o.forEach(n=>n.addEventListener("click",()=>t.execCall({...e,_type:"func",args:r(a,n)}))),!0}}(jaxon.cmd.script,jaxon.parser.call,jaxon.ajax.parameters,jaxon.ajax.command,jaxon.utils.types),jaxon.request=jaxon.ajax.request.execute,jaxon.register=jaxon.ajax.command.register,jaxon.$=jaxon.utils.dom.$,jaxon.setCsrf=jaxon.ajax.request.setCsrf,jaxon.jq=jaxon.parser.query.jq,jaxon.exec=jaxon.parser.call.execExpr,jaxon.confirm=jaxon.dialog.confirm,jaxon.alert=jaxon.dialog.alert,jaxon.getFormValues=jaxon.utils.form.getValues,jaxon.bag.setEntry=jaxon.ajax.parameters.setBagEntry,jaxon.bag.getEntry=jaxon.ajax.parameters.getBagEntry,jaxon.bag.setValue=jaxon.ajax.parameters.setBagValue,jaxon.bag.getValue=jaxon.ajax.parameters.getBagValue,jaxon.processCustomAttrs=jaxon.parser.attr.process,jaxon.logger=jaxon.utils.log.logger,jaxon.isLoaded=!0,function(e,t,n,o){e("response.complete",(e,{request:t})=>(n.response.complete(t),!0),"Response complete"),e("node.assign",t.node.assign,"Node::Assign"),e("node.append",t.node.append,"Node::Append"),e("node.prepend",t.node.prepend,"Node::Prepend"),e("node.replace",t.node.replace,"Node::Replace"),e("node.clear",t.node.clear,"Node::Clear"),e("node.remove",t.node.remove,"Node::Remove"),e("node.create",t.node.create,"Node::Create"),e("node.insert.before",t.node.insertBefore,"Node::InsertBefore"),e("node.insert.after",t.node.insertAfter,"Node::InsertAfter"),e("node.bind",t.node.bind,"Node::Bind"),e("script.exec.call",t.script.execCall,"Script::ExecJsonCall"),e("script.exec.expr",t.script.execExpr,"Script::ExecJsonExpr"),e("script.redirect",t.script.redirect,"Script::Redirect"),e("script.sleep",t.script.sleep,"Script::Sleep"),e("handler.event.set",t.event.setEventHandler,"Script::SetEventHandler"),e("handler.event.add",t.event.addEventHandler,"Script::AddEventHandler"),e("handler.add",t.event.addHandler,"Script::AddHandler"),e("handler.remove",t.event.removeHandler,"Script::RemoveHandler"),e("script.debug",({message:e})=>(o.consoleMode().debug(e),!0),"Debug message"),e("pg.paginate",t.script.paginate,"Paginator::Paginate"),e("databag.set",t.script.setDatabag,"Databag::SetValues"),e("dialog.confirm",t.dialog.execConfirm,"Dialog::Confirm"),e("dialog.alert.show",t.dialog.showAlert,"Dialog::ShowAlert"),e("dialog.modal.show",t.dialog.showModal,"Dialog::ShowModal"),e("dialog.modal.hide",t.dialog.hideModal,"Dialog::HideModal")}(jaxon.register,jaxon.cmd,jaxon.ajax,jaxon.utils.log);