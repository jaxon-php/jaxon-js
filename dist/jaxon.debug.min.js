/*
    @package jaxon
    @version $Id: jaxon.debug.js 327 2007-02-28 16:55:26Z calltoconstruct $
    @copyright Copyright (c) 2005-2007 by Jared White & J. Max Wilson
    @copyright Copyright (c) 2008-2009 by Joseph Woolley, Steffen Konerow, Jared White  & J. Max Wilson
    @license http://www.jaxonproject.org/bsd_license.txt BSD License
*/
try{if("undefined"==typeof jaxon)throw{name:"SequenceError",message:"Error: Jaxon core was not detected, debug module disabled."};void 0===jaxon.debug&&(jaxon.debug={})}catch(e){alert(e.name+": "+e.message)}!function(e,t,n,o,r,a){const s="jaxonWork"+(new Date).getTime();e.windowSource="about:blank",e.windowID="jaxon_debug_"+s,e.windowStyle="width=800,height=600,scrollbars=yes,resizable=yes,status=yes",e.windowTemplate='<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><head><title>jaxon debug output</title><style type="text/css">/* <![CDATA[ */.debugEntry { margin: 3px; padding: 3px; border-top: 1px solid #999999; } .debugDate { font-weight: bold; margin: 2px; } .debugText { margin: 2px; } .warningText { margin: 2px; font-weight: bold; } .errorText { margin: 2px; font-weight: bold; color: #ff7777; }/* ]]> */</style></head><body><h2>jaxon debug output</h2><div id="debugTag"></div></body></html>',e.isLoaded=!0,e.verbose.isLoaded=!1,e.verbose.active=!1;const c=function(t){if(void 0!==t.code){if(void 0!==e.exceptions[t.code]){const n=e.exceptions[t.code];return void 0!==t.data&&n.replace("{data}",t.data),n}}else if(void 0!==t.name){return void 0!==t.message?t.name+": "+t.message:t.name}return"An unknown error has occurred."};e.prepareDebugText=function(t){try{return t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br />")}catch(n){const o=function(e,t,n){const o=e.split(t);e="";for(let t=0;t<o.length;++t)0!=t&&(e+=n),e+=o[t];return e};e.prepareDebugText=function(e){return e=o(e,"&","&amp;"),e=o(e,"<","&lt;"),e=o(e,">","&gt;"),e=o(e,"\n","<br />")},e.prepareDebugText(t)}};const i=function(t,n,o){try{e.window&&!e.window.closed||(e.window=window.open(e.windowSource,e.windowID,e.windowStyle),"about:blank"==e.windowSource&&e.window.document.write(e.windowTemplate));const r=e.window.document;void 0===n&&(n=""),void 0===o&&(o="debugText"),t=e.prepareDebugText(t);const a=r.getElementById("debugTag"),s=r.createElement("div"),c=r.createElement("span"),i=r.createElement("pre");c.innerHTML=(new Date).toString(),i.innerHTML=n+t,s.appendChild(c),s.appendChild(i),a.insertBefore(s,a.firstChild);try{s.className="debugEntry",c.className="debugDate",i.className=o}catch(e){}}catch(n){t.length>1500&&(t=t.substr(0,1500)+" ...\n(Truncated)"),alert(e.messages.heading+t)}},d=r.unregister("dbg");r.register("dbg",(function(t){return t.cmdFullName="debug message",i(t.data,e.messages.warning,"warningText"),d(t)}));const u=r.execute;r.execute=function(t){try{if(void 0===t.cmd)throw{code:10006};if(0==r.isRegistered(t))throw{code:10007,data:t.cmd};return u(t)}catch(n){let o="jaxon.ajax.handler.execute (";void 0!==t.sequence&&(o+="#"+t.sequence+", "),void 0!==t.cmdFullName&&(o+='"'+t.cmdFullName+'"'),o+="):\n"+c(n)+"\n",i(o,e.messages.error,"errorText")}return!0};const l=a.dom.$;a.dom.$=function(t){try{const e=l(t);if("object"!=typeof e)throw{code:10008};return e}catch(t){const n="$:"+c(t)+"\n";i(n,e.messages.warning,"warningText")}};const g=n._send;n._send=function(t){try{const n=t.requestData.length||0;i(e.messages.request.sending),t.beginDate=new Date,g(t),i(e.messages.request.sent.supplant({length:n}))}catch(t){const n="jaxon.ajax.request._send: "+c(t)+"\n";throw i(n,e.messages.error,"errorText"),t}};const m=n.submit;n.submit=function(t){let n=t.method+": "+t.URI+"\n",o=decodeURIComponent(t.requestData);o=o.replace(new RegExp("&jxn","g"),"\n&jxn"),n+=o,i(n),n=e.messages.request.calling;for(let e in t.functionName)n+="\n"+e+": "+t.functionName[e];i(n);try{return m(t)}catch(e){if(i(e.message),0<t.retry)throw e}};const p=n.initialize;n.initialize=function(t){try{const n=e.messages.request.init;return i(n),p(t)}catch(t){const n="jaxon.ajax.request.initialize: "+c(t)+"\n";throw i(n,e.messages.error,"errorText"),t}};const x=t.process;t.process=function(t){try{if(void 0!==t.parameters){const n=e.messages.processing.parameters.supplant({count:t.parameters.length});i(n)}else{const t=e.messages.processing.no_parameters;i(t)}return x(t)}catch(t){const n="jaxon.ajax.parameters.process: "+c(t)+"\n";throw i(n,e.messages.error,"errorText"),t}};const f=n.prepare;n.prepare=function(t){try{const n=e.messages.request.preparing;return i(n),f(t)}catch(t){const n="jaxon.ajax.request.prepare: ";throw c(t),i(n,e.messages.error,"errorText"),t}};const h=r.call;r.call=function(){try{if(0==arguments.length)throw{code:10009};const t=arguments[0],n=h(t);return i(e.messages.processing.calling.supplant({cmd:t.fullName||t.cmd,options:JSON.stringify({...t.id?{id:t.id}:{},prop:t.prop,data:t.data},null,2)})),n}catch(t){const n="jaxon.ajax.handler.call: "+c(t)+"\n";throw i(n,e.messages.error,"errorText"),t}};const j=n.execute;n.execute=function(){try{i(e.messages.request.starting);const t=arguments.length;if(0==t)throw{code:10010};const n=arguments[0],o=1<t?arguments[1]:{};return o.debugging=!0,j(n,o)}catch(t){const n="jaxon.ajax.request.execute: "+c(t)+"\n";throw i(n,e.messages.error,"errorText"),t}};const w=o.received;o.received=function(t){try{const n=t.response.status;if(o.isSuccessCode(n)){t.midDate=new Date;const o=e.messages.response.success.supplant({status:n,length:JSON.stringify(t.responseContent).length,duration:t.midDate-t.beginDate})+"\n"+JSON.stringify(t.responseContent,null,2);i(o)}else if(o.isErrorCode(n)){const o=e.messages.response.content.supplant({status:n,text:JSON.stringify(t.responseContent,null,2)});i(o,e.messages.error,"errorText")}else if(o.isRedirectCode(n)){const n=e.messages.response.redirect.supplant({location:t.response.headers.get("location")});i(n)}return w(t)}catch(t){const n="jaxon.ajax.response.received: "+c(t)+"\n";i(n,e.messages.error,"errorText")}return null};const b=n.complete;if(n.complete=function(t){try{const n=b(t);t.endDate=new Date;const o=t.endDate-t.beginDate,r=e.messages.processing.done.supplant({duration:o});return i(r),n}catch(t){const n="jaxon.ajax.request.complete: "+c(t)+"\n";throw i(n,e.messages.error,"errorText"),t}},jaxon.cmd.body.assign){const t=jaxon.cmd.body.assign;jaxon.cmd.body.assign=function({target:n,prop:o,data:r}){try{return t(n,o,r)}catch(t){const n="jaxon.cmd.body.assign: "+c(t)+"\nEval: element."+o+" = data;\n";i(n,e.messages.error,"errorText")}return!0}}}(jaxon.debug,jaxon.ajax.parameters,jaxon.ajax.request,jaxon.ajax.response,jaxon.ajax.handler,jaxon.utils),jaxon.dom.ready((function(){(function(self){if(!self.active)return;const expandObject=function(e){if("function"==typeof e)return"[Function]";if("object"==typeof e){if(1==(!(1<arguments.length)||arguments[1])){let t=" { ",n="";for(let o in e){t+=n,t+=o,t+=": ";try{t+=expandObject(e[o],!1)}catch(e){t+="[n/a]"}n=", "}return t+=" } ",t}return"[Object]"}return'"'+e+'"'},makeFunction=function(obj,name){return function(){let fun=name+"(",separator="";const pLen=arguments.length;for(let e=0;e<pLen;++e)fun+=separator,fun+=expandObject(arguments[e]),separator=",";fun+=");";let msg="--\x3e "+fun;writeDebugMessage(msg);const returnValue=!0;let code="returnValue = obj(";separator="";for(let e=0;e<pLen;++e)code+=separator+"arguments["+e+"]",separator=",";return code+=");",eval(code),msg="<-- "+fun+" returns "+expandObject(returnValue),writeDebugMessage(msg),returnValue}};self.hook=function(e,t){for(let n in e)"function"==typeof e[n]&&(e[n]=makeFunction(e[n],t+n))},self.hook(jaxon,"jaxon."),self.hook(jaxon.cmd.body,"jaxon.cmd.body."),self.hook(jaxon.cmd.event,"jaxon.cmd.event."),self.hook(jaxon.cmd.form,"jaxon.cmd.form."),self.hook(jaxon.cmd.head,"jaxon.cmd.head."),self.hook(jaxon.cmd.script,"jaxon.cmd.script."),self.hook(jaxon.utils.dom,"jaxon.utils.dom."),self.hook(jaxon.utils.string,"jaxon.utils.string."),self.hook(jaxon.utils.queue,"jaxon.utils.queue."),self.hook(jaxon.utils.upload,"jaxon.utils.upload."),self.hook(jaxon.ajax.callback,"jaxon.ajax.callback."),self.hook(jaxon.ajax.handler,"jaxon.ajax.handler."),self.isLoaded=!0})(jaxon.debug.verbose)}));