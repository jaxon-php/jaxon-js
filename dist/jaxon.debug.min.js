/*
    @package jaxon
    @version $Id: jaxon.debug.js 327 2007-02-28 16:55:26Z calltoconstruct $
    @copyright Copyright (c) 2005-2007 by Jared White & J. Max Wilson
    @copyright Copyright (c) 2008-2009 by Joseph Woolley, Steffen Konerow, Jared White  & J. Max Wilson
    @license http://www.jaxonproject.org/bsd_license.txt BSD License
*/
try{if("undefined"==typeof jaxon)throw{name:"SequenceError",message:"Error: Jaxon core was not detected, debug module disabled."};void 0===jaxon.debug&&(jaxon.debug={})}catch(e){alert(e.name+": "+e.message)}jaxon.debug.workId="jaxonWork"+(new Date).getTime(),jaxon.debug.windowSource="about:blank",jaxon.debug.windowID="jaxon_debug_"+jaxon.debug.workId,void 0===jaxon.debug.windowStyle&&(jaxon.debug.windowStyle="width=800,height=600,scrollbars=yes,resizable=yes,status=yes"),void 0===jaxon.debug.windowTemplate&&(jaxon.debug.windowTemplate='<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><head><title>jaxon debug output</title><style type="text/css">/* <![CDATA[ */.debugEntry { margin: 3px; padding: 3px; border-top: 1px solid #999999; } .debugDate { font-weight: bold; margin: 2px; } .debugText { margin: 2px; } .warningText { margin: 2px; font-weight: bold; } .errorText { margin: 2px; font-weight: bold; color: #ff7777; }/* ]]> */</style></head><body><h2>jaxon debug output</h2><div id="debugTag"></div></body></html>'),jaxon.debug.getExceptionText=function(e){if(void 0!==e.code){if(void 0!==jaxon.debug.exceptions[e.code]){var a=jaxon.debug.exceptions[e.code];return void 0!==e.data&&a.replace("{data}",e.data),a}}else if(void 0!==e.name){a=e.name;return void 0!==e.message&&(a+=": ",a+=e.message),a}return"An unknown error has occurred."},jaxon.debug.writeMessage=function(e,a,n){try{var o=jaxon.debug;void 0!==o.window&&1!=o.window.closed||(o.window=window.open(o.windowSource,o.windowID,o.windowStyle),"about:blank"==o.windowSource&&o.window.document.write(o.windowTemplate));var r=o.window.document;void 0===a&&(a=""),void 0===n&&(n="debugText"),e=jaxon.debug.prepareDebugText(e);var t=r.getElementById("debugTag"),s=r.createElement("div"),x=r.createElement("span"),u=r.createElement("pre");x.innerHTML=(new Date).toString(),u.innerHTML=a+e,s.appendChild(x),s.appendChild(u),t.insertBefore(s,t.firstChild);try{s.className="debugEntry",x.className="debugDate",u.className=n}catch(e){}}catch(a){e.length>1e3&&(e=e.substr(0,1e3)+jaxon.debug.messages.heading),alert(jaxon.debug.messages.heading+e)}},jaxon.debug.prepareDebugText=function(e){try{return e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br />")}catch(a){jaxon.debug.stringReplace=function(e,a,n){var o=e.split(a);e="";for(var r=0;r<o.length;++r)0!=r&&(e+=n),e+=o[r];return e},jaxon.debug.prepareDebugText=function(e){return e=jaxon.debug.stringReplace(e,"&","&amp;"),e=jaxon.debug.stringReplace(e,"<","&lt;"),e=jaxon.debug.stringReplace(e,">","&gt;"),e=jaxon.debug.stringReplace(e,"\n","<br />")},jaxon.debug.prepareDebugText(e)}},jaxon.debug.commandHandler=jaxon.ajax.handler.unregister("dbg"),jaxon.ajax.handler.register("dbg",(function(e){return e.cmdFullName="debug message",jaxon.debug.writeMessage(e.data,jaxon.debug.messages.warning,"warningText"),jaxon.debug.commandHandler(e)})),jaxon.debug.executeCommand=jaxon.ajax.handler.execute,jaxon.ajax.handler.execute=function(e){try{if(void 0===e.cmd)throw{code:10006};if(0==jaxon.ajax.handler.isRegistered(e))throw{code:10007,data:e.cmd};return jaxon.debug.executeCommand(e)}catch(n){var a="jaxon.ajax.handler.execute (";void 0!==e.sequence&&(a+="#",a+=e.sequence,a+=", "),void 0!==e.cmdFullName&&(a+='"',a+=e.cmdFullName,a+='"'),a+="):\n",a+=jaxon.debug.getExceptionText(n),a+="\n",jaxon.debug.writeMessage(a,jaxon.debug.messages.error,"errorText")}return!0},jaxon.debug.$=jaxon.utils.dom.$,jaxon.utils.dom.$=function(e){var a=void 0;try{if("object"!=typeof(a=jaxon.debug.$(e)))throw{code:10008}}catch(e){var n="$:";n+=jaxon.debug.getExceptionText(e),n+="\n",jaxon.debug.writeMessage(n,jaxon.debug.messages.warning,"warningText")}return a},jaxon.debug._internalSend=jaxon.ajax.request._send,jaxon.ajax.request._send=function(e){try{var a=e.requestData.length||0;jaxon.debug.writeMessage(jaxon.debug.messages.request.sending),e.beginDate=new Date,jaxon.debug._internalSend(e),jaxon.debug.writeMessage(jaxon.debug.messages.request.sent.supplant({length:a}))}catch(e){var n="jaxon.ajax.request._send: ";throw n+=jaxon.debug.getExceptionText(e),n+="\n",jaxon.debug.writeMessage(n,jaxon.debug.messages.error,"errorText"),e}},jaxon.debug.submitRequest=jaxon.ajax.request.submit,jaxon.ajax.request.submit=function(e){var a=e.method;a+=": "+e.URI+"\n";var n=decodeURIComponent(e.requestData);a+=n=n.replace(new RegExp("&jxn","g"),"\n&jxn"),jaxon.debug.writeMessage(a),a=jaxon.debug.messages.request.calling;var o="\n";for(var r in e.functionName)a+=o,a+=r,a+=": ",a+=e.functionName[r],o="\n";jaxon.debug.writeMessage(a);try{return jaxon.debug.submitRequest(e)}catch(a){if(jaxon.debug.writeMessage(a.message),0<e.retry)throw a}},jaxon.debug.initializeRequest=jaxon.ajax.request.initialize,jaxon.ajax.request.initialize=function(e){try{var a=jaxon.debug.messages.request.init;return jaxon.debug.writeMessage(a),jaxon.debug.initializeRequest(e)}catch(e){a="jaxon.ajax.request.initialize: ";throw a+=jaxon.debug.getExceptionText(e),a+="\n",jaxon.debug.writeMessage(a,jaxon.debug.messages.error,"errorText"),e}},jaxon.debug.processParameters=jaxon.ajax.parameters.process,jaxon.ajax.parameters.process=function(e){try{if(void 0!==e.parameters){var a=jaxon.debug.messages.processing.parameters.supplant({count:e.parameters.length});jaxon.debug.writeMessage(a)}else{a=jaxon.debug.messages.processing.no_parameters;jaxon.debug.writeMessage(a)}return jaxon.debug.processParameters(e)}catch(e){a="jaxon.ajax.parameters.process: ";throw a+=jaxon.debug.getExceptionText(e),a+="\n",jaxon.debug.writeMessage(a,jaxon.debug.messages.error,"errorText"),e}},jaxon.debug.prepareRequest=jaxon.ajax.request.prepare,jaxon.ajax.request.prepare=function(e){try{var a=jaxon.debug.messages.request.preparing;return jaxon.debug.writeMessage(a),jaxon.debug.prepareRequest(e)}catch(e){a="jaxon.ajax.request.prepare: ";throw a+=jaxon.debug.getExceptionText(e),a+="\n",jaxon.debug.writeMessage(a,jaxon.debug.messages.error,"errorText"),e}},jaxon.debug.call=jaxon.ajax.handler.call,jaxon.ajax.handler.call=function(){try{if(0==arguments.length)throw{code:10009};var e=arguments[0],a=jaxon.debug.call(e);return jaxon.debug.writeMessage(jaxon.debug.messages.processing.calling.supplant({cmd:e.fullName||e.cmd,options:JSON.stringify({prop:e.prop,data:e.data})})),a}catch(e){var n="jaxon.ajax.handler.call: ";throw n+=jaxon.debug.getExceptionText(e),n+="\n",jaxon.debug.writeMessage(n,jaxon.debug.messages.error,"errorText"),e}},jaxon.debug.request=jaxon.ajax.request.execute,jaxon.ajax.request.execute=function(){try{jaxon.debug.writeMessage(jaxon.debug.messages.request.starting);var e=arguments.length;if(0==e)throw{code:10010};var a=arguments[0],n={};return 1<e&&(n=arguments[1]),n.debugging=!0,jaxon.debug.request(a,n)}catch(e){var o="jaxon.ajax.request.execute: ";throw o+=jaxon.debug.getExceptionText(e),o+="\n",jaxon.debug.writeMessage(o,jaxon.debug.messages.error,"errorText"),e}},jaxon.debug.responseReceived=jaxon.ajax.response.received,jaxon.ajax.response.received=function(e){var a,n=jaxon,o=n.tools,r=n.debug;try{var t=e.request.status;if(o.array.is_in(n.ajax.response.successCodes,t)){var s=e.request.responseText;s=(s=(s=(s=(s=(s=s.replace(new RegExp("<cmd","g"),"\n<cmd")).replace(new RegExp("<jxn>","g"),"\n<jxn>")).replace(new RegExp("<jxnobj>","g"),"\n<jxnobj>")).replace(new RegExp("<e>","g"),"\n<e>")).replace(new RegExp("</jxnobj>","g"),"\n</jxnobj>\n")).replace(new RegExp("</jxn>","g"),"\n</jxn>"),e.midDate=new Date;var x=jaxon.debug.messages.response.success.supplant({status:t,length:s.length,duration:e.midDate-e.beginDate});x+=s,r.writeMessage(x)}else if(o.array.is_in(n.ajax.response.errorsForAlert,t)){x=jaxon.debug.messages.response.content.supplant({status:t,text:e.request.responseText});r.writeMessage(x,jaxon.debug.messages.error,"errorText")}else if(o.array.is_in(n.ajax.response.redirectCodes,t)){x=jaxon.debug.messages.response.redirect.supplant({location:e.request.getResponseHeader("location")});r.writeMessage(x)}a=r.responseReceived(e)}catch(e){x="jaxon.ajax.response.received: ";x+=jaxon.debug.getExceptionText(e),x+="\n",r.writeMessage(x,jaxon.debug.messages.error,"errorText")}return a},jaxon.debug.completeResponse=jaxon.ajax.request.complete,jaxon.ajax.request.complete=function(e){try{var a=jaxon.debug.completeResponse(e);e.endDate=new Date;var n=e.endDate-e.beginDate,o=jaxon.debug.messages.processing.done.supplant({duration:n});return jaxon.debug.writeMessage(o),a}catch(e){o="jaxon.ajax.request.complete: ";throw o+=jaxon.debug.getExceptionText(e),o+="\n",jaxon.debug.writeMessage(o,jaxon.debug.messages.error,"errorText"),e}},jaxon.cmd.body.assign&&(jaxon.debug.assign=jaxon.cmd.body.assign,jaxon.cmd.body.assign=function({target:e,prop:a,data:n}){try{return jaxon.debug.assign(e,a,n)}catch(e){var o="jaxon.cmd.body.assign: ";o+=jaxon.debug.getExceptionText(e),o+="\n",o+="Eval: element.",o+=a,o+=" = data;\n",jaxon.debug.writeMessage(o,jaxon.debug.messages.error,"errorText")}return!0}),jaxon.debug.isLoaded=!0,jxn={},jxn.$=jaxon.utils.dom.$,jxn.getFormValues=jaxon.utils.form.getValues,jxn.call=jaxon.ajax.handler.call,jxn.request=jaxon.ajax.request.execute,jaxon.dom.ready((function(){jaxon.debug.verbose.active&&(jaxon.debug.verbose.expandObject=function(e){var a=!0;if(1<arguments.length&&(a=arguments[1]),"function"==typeof e)return"[Function]";if("object"==typeof e){if(1==a){var n=" { ",o="";for(var r in e){n+=o,n+=r,n+=": ";try{n+=jaxon.debug.verbose.expandObject(e[r],!1)}catch(e){n+="[n/a]"}o=", "}return n+=" } "}return"[Object]"}return'"'+e+'"'},jaxon.debug.verbose.makeFunction=function(obj,name){return function(){var fun=name;fun+="(";for(var separator="",pLen=arguments.length,p=0;p<pLen;++p)fun+=separator,fun+=jaxon.debug.verbose.expandObject(arguments[p]),separator=",";fun+=");";var msg="--\x3e ";msg+=fun,jaxon.debug.writeMessage(msg);var returnValue=!0,code="returnValue = obj(";separator="";for(var p=0;p<pLen;++p)code+=separator,code+="arguments["+p+"]",separator=",";return code+=");",eval(code),msg="<-- ",msg+=fun,msg+=" returns ",msg+=jaxon.debug.verbose.expandObject(returnValue),jaxon.debug.writeMessage(msg),returnValue}},jaxon.debug.verbose.hook=function(e,a){for(var n in e)"function"==typeof e[n]&&(e[n]=jaxon.debug.verbose.makeFunction(e[n],a+n))},jaxon.debug.verbose.hook(jaxon,"jaxon."),jaxon.debug.verbose.hook(jaxon.cmd.body,"jaxon.cmd.body."),jaxon.debug.verbose.hook(jaxon.cmd.event,"jaxon.cmd.event."),jaxon.debug.verbose.hook(jaxon.cmd.form,"jaxon.cmd.form."),jaxon.debug.verbose.hook(jaxon.cmd.head,"jaxon.cmd.head."),jaxon.debug.verbose.hook(jaxon.cmd.script,"jaxon.cmd.script."),jaxon.debug.verbose.hook(jaxon.utils.dom,"jaxon.utils.dom."),jaxon.debug.verbose.hook(jaxon.utils.string,"jaxon.utils.string."),jaxon.debug.verbose.hook(jaxon.utils.queue,"jaxon.utils.queue."),jaxon.debug.verbose.hook(jaxon.utils.upload,"jaxon.utils.upload."),jaxon.debug.verbose.hook(jaxon.ajax.callback,"jaxon.ajax.callback."),jaxon.debug.verbose.hook(jaxon.ajax.handler,"jaxon.ajax.handler."))})),jaxon.debug.verbose.isLoaded=!0,jaxon.debug.verbose.active=!1;